\documentclass[12pt, titlepage]{article}

\usepackage{amsmath, mathtools}

\usepackage[round]{natbib}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{xr}
\usepackage{hyperref}
\usepackage{longtable}
\usepackage{xfrac}
\usepackage{tabularx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[section]{placeins}
\usepackage{caption}
\usepackage{fullpage}
\usepackage{fixltx2e}

\hypersetup{
bookmarks=true,     % show bookmarks bar?
colorlinks=true,       % false: boxed links; true: colored links
linkcolor=red,          % color of internal links (change box color with linkbordercolor)
citecolor=blue,      % color of links to bibliography
filecolor=magenta,  % color of file links
urlcolor=cyan          % color of external links
}

\usepackage{array}

\externaldocument{../../SRS/SRS}

\input{../../Comments}
\input{../../Common}

\begin{document}

\title{Module Interface Specification for Bridge Corrosion}

\author{Cynthia Liu}

\date{\today}

\maketitle

\pagenumbering{roman}

\section{Revision History}

\begin{tabularx}{\textwidth}{p{3cm}p{2cm}X}
\toprule {\bf Date} & {\bf Version} & {\bf Notes}\\
\midrule
Mar. 8, 2024 & 1.0 & Initial Release\\
\bottomrule
\end{tabularx}

~\newpage

\section{Symbols, Abbreviations and Acronyms}

See SRS Documentation at \href{https://github.com/CynthiaLiu0805/BridgeCorrosion/blob/main/docs/SRS/SRS.pdf}{SRS}.

\wss{Also add any additional symbols, abbreviations or acronyms}

\newpage

\tableofcontents

\newpage

\pagenumbering{arabic}

\section{Introduction}

The following document details the Module Interface Specifications for Bridge Corrosion which investigate how climate, traffic might impact corrosion-induced
damage for reinforced concrete bridges by influencing the chloride exposure.
%\wss{Fill in your project name and description}

Complementary documents include the System Requirement Specifications
and Module Guide.  The full documentation and implementation can be
found at \href{https://github.com/CynthiaLiu0805/BridgeCorrosion}{here}.

\section{Notation}

%\wss{You should describe your notation.  You can use what is below as a starting point.}

The structure of the MIS for modules comes from [HoffmanAndStrooper1995],
with the addition that template modules have been adapted from
[GhezziEtAl2003].  The mathematical notation comes from Chapter 3 of
[HoffmanAndStrooper1995].  For instance, the symbol := is used for a
multiple assignment statement and conditional rules follow the form $(c_1
\Rightarrow r_1 | c_2 \Rightarrow r_2 | ... | c_n \Rightarrow r_n )$.

The following table summarizes the primitive data types used by BC. 
\begin{center}
\renewcommand{\arraystretch}{1.2}
\noindent 
\begin{tabular}{l l p{7.5cm}} 
\toprule 
\textbf{Data Type} & \textbf{Notation} & \textbf{Description}\\ 
\midrule
character & char & a single symbol or digit\\
integer & $\mathbb{Z}$ & a number without a fractional component in (-$\infty$, $\infty$) \\
natural number & $\mathbb{N}$ & a number without a fractional component in [1, $\infty$) \\
real & $\mathbb{R}$ & any number in (-$\infty$, $\infty$)\\
empty & $\varnothing$ & when the input is empty or the variable does not exist \\
\bottomrule
\end{tabular} 
\end{center}

\noindent
The specification of BC uses some derived data types: sequences, strings, and
tuples. Sequences are lists filled with elements of the same data type. Strings
are sequences of characters. Tuples contain a list of values, potentially of
different types. In addition, BC uses functions, which
are defined by the data types of their inputs and outputs. Local functions are
described by giving their type signature followed by their specification.

\section{Module Decomposition}

The following table is taken directly from the Module Guide document for this project.

\begin{table}[h!]
\centering
\begin{tabular}{p{0.3\textwidth} p{0.6\textwidth}}
\toprule
\textbf{Level 1} & \textbf{Level 2}\\
\midrule

{Hardware Hiding} & ~ \\
\midrule

\multirow{5}{0.3\textwidth}{Behaviour-Hiding Module} & Input Parameter Module\\
& Input Verification Module\\
& Control Module\\
& Data Searching Module\\
& Output Visualization Module\\

\midrule

\multirow{3}{0.3\textwidth}{Software Decision Module} & Chloride Exposure Calculation Module \\
& Sequence Data Structure Module \\
& Plotting Module \\
\bottomrule

\end{tabular}
\caption{Module Hierarchy}
\label{TblMH}
\end{table}

\newpage
~\newpage

\section{MIS of Control Module} \label{controlModule} 
This module provides the main program and the GUI of the software. It is related to R1 and R2 in the SRS.
%\wss{You can reference SRS labels, such as R\ref{R_Inputs}.}

%\wss{It is also possible to use \LaTeX for hypperlinks to external documents.}

\subsection{Module}

main

\subsection{Uses}
\begin{itemize}
\item Input Parameter Module (Section \ref{inputParameterModule})
\item Input Verification Module (Section \ref{inputVerificationModule})
\item Data Searching Module (Section \ref{dataSearchingModule})
\item Output Visualization Module (Section \ref{outputVisualizationModule})
\end{itemize}


\subsection{Syntax}

\subsubsection{Exported Constants}

None

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{5cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
main & long: $\mathbb{R}$, lat: $\mathbb{R}$  & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
\begin{itemize}
\item long, lat := long: $\mathbb{R}$, lat: $\mathbb{R}$ \# input coordinate get from Input Parameter Module.
\item result = sequence of $\mathbb{R}$ \# the predicted chloride exposure trend

\end{itemize}
%\wss{Not all modules will have state variables.  State variables give the module a memory.}

\subsubsection{Environment Variables}

None

%\wss{This section is not necessary for all modules.  Its purpose is to capture when the module has external interaction with the environment, such as for a device driver, screen interface, keyboard, file, etc.}

\subsubsection{Assumptions}

None
%\wss{Try to minimize assumptions and anticipate programmer errors via exceptions, but for practical purposes assumptions are sometimes appropriate.}

\subsubsection{Access Routine Semantics}

\noindent main():
\begin{itemize}
\item transition: Control and execute the other modules as follow:
\begin{itemize}
\item Get input from user by Input Parameter Module. (M2, Section \ref{inputParameterModule}) 
\item Pass the input to Input Verification Module. (M3, Section \ref{inputVerificationModule})
\item Search the corresponding data in Data Searching Module if the input is valid. (M5, Section \ref{dataSearchingModule})
\item Visualize the resulting data by using Output Visualization Module. (M6, Section \ref{outputVisualizationModule})

\end{itemize}
\item output: out := None
\item exception: exc := Exceptions are handled in other submodules.
\end{itemize}

%\wss{A module without environment variables or state variables is unlikely to have a state transition.  In this case a state transition can only occur if the module is changing the state of another module.}

%\wss{Modules rarely have both a transition and an output.  In most cases you will have one or the other.}

\subsubsection{Local Functions}
None
%\wss{As appropriate} \wss{These functions are for the purpose of specification. They are not necessarily something that is going to be implemented explicitly.  Even if they are implemented, they are not exported; they only have local scope.}
  
~\newpage

\section{MIS of Input Parameter Module} \label{inputParameterModule} 
This module hides the format and structure of the input data, it is related to R1 in SRS.
\subsection{Module}
param
\subsection{Uses}
None

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4.5cm} p{3cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
param & long: String, lat: String & long: $\mathbb{R}$, lat: $\mathbb{R}$ & InputTypeMismatchError \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
None

\subsubsection{Environment Variables}
Keyboard: this module takes input from the keyboard by typing.


\subsubsection{Assumptions}
None

\subsubsection{Access Routine Semantics}
This module load the input data and save it to the data type needed by the Input Verification Module.\\
\noindent \textbf{read\_input()}:
\begin{itemize}
\item transition: Get input from the user, pass the input to the Input Verification Module.
\item output: out := None
\item exception: exc:= \\ \\ 
 \begin{tabular}{p{10cm} p{3.5cm} }
 \hline
 \textbf{Expression} & \textbf{Exception}  \\

  \hline
     isNumeric(long) != float $\lor$ isNumeric(lat) != float   & InputTypeMismatchError \\ \\

  \hline
 \end{tabular}
\end{itemize}


\subsubsection{Local Functions}
\noindent isNumeric($e$):
\begin{itemize}
\item output: out := Boolean \# check if the input $e$ is a string of float 
\end{itemize}
  
  
~\newpage

\section{MIS of Input Verification Module} \label{inputVerificationModule} 
This module verifies if the input is within the physical and software constraints, it is related to R1 in SRS.
\subsection{Module}

verify\_param

\subsection{Uses}
Input Parameter Module (Section \ref{inputParameterModule})

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{3cm} p{4cm} p{2cm} p{5cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
read\_geoinfo & filename: String & - & FileNotFoundError\\
verify\_param & long: $\mathbb{R}$, lat: $\mathbb{R}$ & Boolean & InputOutofOntarioError \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
\begin{itemize}

\item isValid: Boolean \# if this input is valid

\end{itemize}

\subsubsection{Environment Variables}
\begin{itemize}

\item File: String \# the geojson file that contain the shape of Ontario.

\end{itemize}

\subsubsection{Assumptions}
This module use the open source geojson file that contain the Ontario boundary, by drawing polygons with the vertex coordinate. The coordinates for those vertexes are assumed to be reliable.

\subsubsection{Access Routine Semantics}
\noindent \textbf{read\_geoinfo($filename$)}:
\begin{itemize}
\item transition: access the data from geojson file
\item exception: exc := FileNotFoundError: $filename == \varnothing$
\end{itemize}
\noindent \textbf{verify\_param($long, lat$)}:
\begin{itemize}
\item output: out := isValid
\item exception: exc := InputOutofOntarioError: $\lnot ((long, lat) \in Ontario)$
\end{itemize}

\subsubsection{Local Functions}
None
  
~\newpage

\section{MIS of Data Searching Module} \label{dataSearchingModule} 
This module finds the data needed in the database, it is related to R2 in SRS.
\subsection{Module}

search

\subsection{Uses}
 Input Parameter Module (Section \ref{inputParameterModule})
, Chloride Exposure Calculation Module (Section \ref{calculationModule})


\subsection{Syntax}

\subsubsection{Exported Constants}
None
\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
read\_file & file: String & data: sequence of $\mathbb{R}$ & FileNotFoundError \\
search & long: $\mathbb{R}$, lat: $\mathbb{R}$  & result: sequence of  $\mathbb{R}$ & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
\begin{itemize}
\item data: sequence of $\mathbb{R}$ \# the sequence of data read from database
\item result: sequence of $\mathbb{R}$ \# the sequence of predicted chloride exposure data

\end{itemize}

\subsubsection{Environment Variables}
None

\subsubsection{Assumptions}
All locations within Ontario must contain valid data. If a user inputs a location outside of Ontario, it will be handled by the Input Verification Module.

\subsubsection{Access Routine Semantics}
\noindent \textbf{read\_file($filename$)}:
\begin{itemize}
\item output: out := data \# sequence of $\mathbb{R}$ read from the file
\item exception: exc := FileNotFoundError = $filename == \varnothing$
\end{itemize}
\noindent \textbf{search($long, lat, data$)}:
\begin{itemize}
\item output: out := result = search(find\_grid\_belonged($long, lat, data$))
\item exception: exc := None
\end{itemize}

\subsubsection{Local Functions}
\noindent \textbf{find\_grid\_belonged($long, lat, data$)}: If the input coordinate is not the exact one in data, find the grid that it belongs to and return the center coordinate.
\begin{itemize}
\item output: out := long, lat

\end{itemize}


~\newpage

\section{MIS of Output Visualization Module} \label{outputVisualizationModule}
This module provides the cisualization of the resulting chloride exposure trend, it is related to R2 and R4 in SRS.

\subsection{Module}

draw

\subsection{Uses}

Data Searching Module (Section \ref{dataSearchingModule})


\subsection{Syntax}

\subsubsection{Exported Constants}
None
\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{7cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
draw & result: sequence of $\mathbb{R}$ & graphs & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
None

\subsubsection{Environment Variables}
Screen: The graphs are displayed on the screen.

\subsubsection{Assumptions}
None
\subsubsection{Access Routine Semantics}

\noindent \textbf{draw($long, lat, result$)}:
\begin{itemize}
\item transition: display the graphs using the result from Data Searching Module.
\item output: out := None
\item exception: exc := None
\end{itemize}

\subsubsection{Local Functions}
None
\newpage

\section{MIS of Chloride Exposure Calculation Module} \label{calculationModule}
This module performs the calculation process to generate the database, it is related to the R2, R3, R4 in SRS.

\subsection{Module}

calculate

\subsection{Uses}

None

\subsection{Syntax}

\subsubsection{Exported Constants}
None
\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
calculate & AADT: sequence of $\mathbb{R}$, AADTT: sequence of $\mathbb{R}$, t1: sequence of $\mathbb{N}$, h\textsubscript{total}: sequence of $\mathbb{R}$, t2: sequence of $\mathbb{N}$ & file: String & DataMissingError, DataInvalidError \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}


\subsubsection{State Variables}
None
\subsubsection{Environment Variables}

File: Sequence of String \# the result of calculation will be stored in an output csv file.
\subsubsection{Assumptions}

\begin{itemize}
\item The AADT and AADTT are assumed to have 2\% increase rate every year.
\item The map of Ontario is divided into multiple 25km * 25km grid (as mentioned in SRS) and the coordinates are the center of those grids. The locations inside each grid are consider to have same chloride exposure rate.
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent \textbf{calculate($AADT, AADTT, t1, h_{total}, t2$)}:
\begin{itemize}
\item output: out :=  file = Cl\_mass($spray\_density\_Cl(salt\_per\_day(h_{total}, t1), \\ water\_thickness(h_{total}, t2)),\adjust(AADT, AADTT), t2$) \# the result is saved to a csv file storing calculation result, which is the prediction of chloride exposure rate. The file has row lable as coordinate and column lable as year. 
\item exception: exc:= \\ \\ 
 \begin{tabular}{p{10cm} p{3.5cm} }
 \hline
 \textbf{Expression} & \textbf{Exception}  \\
 \hline
     $\exists e \in [AADT, AADTT, h_{total}, t1, t2], e =\varnothing$ & DataMissingError  \\ \\

  \hline
     $(\exists i \in [0..|AADT|-1], AADTT[i] > AADT[i]) \lor (\neg (t1, t2 \in (0,365)))$   & DataInvalidError \\ \\

  \hline
 \end{tabular}

\end{itemize}

\subsubsection{Local Functions}
\noindent \textbf{adjust($AADT, AADTT$)}: A function that convert AADT and AADTT from sequence to 2-D array, based on the assumption of annually 2\% increase.
\begin{itemize}
\item out := AADT, AADTT
\end{itemize}

\noindent \textbf{salt\_per\_day($h\_total, t1$)}: calcualte the quantity of deicing salts applied on a roadway per day during the winter season.
\begin{itemize}
\item out := M\_app
\end{itemize}

\noindent \textbf{water\_thickness($h\_total, t2$)}: calculate the thickness of melted water per day with snow melting
\begin{itemize}
\item out := h\_app
\end{itemize}

\noindent \textbf{spray\_density\_Cl($M\_app, h\_app$)}: calculate the mass of chloride ions by one truck
\begin{itemize}
\item out := SD\_totalCl
\end{itemize}

\noindent \textbf{Cl\_mass($SD\_totalCl, AADT, AADTT, t2$)}: calculate the final chloride exposure
\begin{itemize}
\item out := Cl\_result
\end{itemize}



\bibliographystyle {plainnat}
\bibliography {../../../refs/References}

\newpage



\end{document}